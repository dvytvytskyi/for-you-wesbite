# –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ–±–ª–µ–º–∏ –∑ API Key/Secret

## ‚úÖ –í–∏—Å–Ω–æ–≤–æ–∫: –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ –ë–ï–ö–ï–ù–î–Ü

### –î–æ–∫–∞–∑–∏:

1. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –∫–ª—é—á—ñ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
   - ‚úÖ API Key: `ak_aa4d19418b385c370939b45365d0c687ddbdef7cbe9a72548748ef67f5e469e1`
   - ‚úÖ API Secret: `as_623caef2632983630ce11293e544504c834a9ab1015fa2c75a7c2583d6f28d7c`
   - ‚úÖ –ü—Ä–µ—Ñ—ñ–∫—Å–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ: `ak_` —Ç–∞ `as_`
   - ‚úÖ –ó–∞–≥–æ–ª–æ–≤–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ: `x-api-key` —Ç–∞ `x-api-secret`
   - ‚úÖ –î–æ–≤–∂–∏–Ω–∞ –∫–ª—é—á—ñ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–∞

2. **–¢–µ—Å—Ç curl —Ç–∞–∫–æ–∂ –Ω–µ –ø—Ä–∞—Ü—é—î:**
   ```bash
   curl -H "x-api-key: ak_aa4d19418b385c370939b45365d0c687ddbdef7cbe9a72548748ef67f5e469e1" \
        -H "x-api-secret: as_623caef2632983630ce11293e544504c834a9ab1015fa2c75a7c2583d6f28d7c" \
        https://admin.foryou-realestate.com/api/public/data
   ```
   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `403 Forbidden` –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º `"Invalid API key or secret"`

3. **–õ–æ–≥–∏ –∑ –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ–∫–∞–∑—É—é—Ç—å:**
   - –ö–ª—é—á—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º
   - –ó–∞–≥–æ–ª–æ–≤–∫–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ
   - –ë–µ–∫–µ–Ω–¥ –æ—Ç—Ä–∏–º—É—î –∑–∞–ø–∏—Ç, –∞–ª–µ –≤—ñ–¥—Ö–∏–ª—è—î –π–æ–≥–æ

## üîç –©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ:

### 1. –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö
- [ ] –ß–∏ —ñ—Å–Ω—É—é—Ç—å —Ü—ñ –∫–ª—é—á—ñ –≤ —Ç–∞–±–ª–∏—Ü—ñ `api_keys` (–∞–±–æ –∞–Ω–∞–ª–æ–≥—ñ—á–Ω—ñ–π)?
- [ ] –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –∫–ª—é—á—ñ (–±–µ–∑ –ø—Ä–æ–±—ñ–ª—ñ–≤, –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç)?
- [ ] –ß–∏ —î –ø–æ–ª–µ `is_active` = `true` –¥–ª—è —Ü–∏—Ö –∫–ª—é—á—ñ–≤?
- [ ] –ß–∏ –Ω–µ –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω—ñ –∫–ª—é—á—ñ (—è–∫—â–æ —î `expires_at`)?

### 2. Middleware `authenticateApiKeyWithSecret`
- [ ] –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —á–∏—Ç–∞—é—Ç—å—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–∏ `x-api-key` —Ç–∞ `x-api-secret`?
- [ ] –ß–∏ case-sensitive –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤? (–º–æ–∂–ª–∏–≤–æ, –æ—á—ñ–∫—É—î `X-Api-Key` –∑–∞–º—ñ—Å—Ç—å `x-api-key`)
- [ ] –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ—Ä—ñ–≤–Ω—é—é—Ç—å—Å—è –∫–ª—é—á—ñ (trim –ø—Ä–æ–±—ñ–ª—ñ–≤, case-sensitive)?
- [ ] –ß–∏ —î –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤ middleware? –Ø–∫—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∏—Ö–æ–¥—è—Ç—å?

### 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ñ API –∫–ª—é—á—ñ–≤
–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ñ:
```sql
-- –ü—Ä–∏–∫–ª–∞–¥ –∑–∞–ø–∏—Ç—É –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
SELECT * FROM api_keys 
WHERE api_key = 'ak_aa4d19418b385c370939b45365d0c687ddbdef7cbe9a72548748ef67f5e469e1'
   OR api_secret = 'as_623caef2632983630ce11293e544504c834a9ab1015fa2c75a7c2583d6f28d7c';
```

### 4. –õ–æ–≥—É–≤–∞–Ω–Ω—è –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ
–î–æ–¥–∞—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤ `authenticateApiKeyWithSecret`:
```javascript
console.log('Received headers:', {
  'x-api-key': req.headers['x-api-key'],
  'x-api-secret': req.headers['x-api-secret'],
  'X-Api-Key': req.headers['X-Api-Key'], // –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ case-sensitive
  'X-Api-Secret': req.headers['X-Api-Secret'],
});
console.log('All headers:', Object.keys(req.headers));
```

### 5. –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏:

#### A. Case-sensitive –∑–∞–≥–æ–ª–æ–≤–∫–∏
–ë–µ–∫–µ–Ω–¥ –º–æ–∂–µ –æ—á—ñ–∫—É–≤–∞—Ç–∏ `X-Api-Key` –∑–∞–º—ñ—Å—Ç—å `x-api-key`. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:
```javascript
// –í middleware
const apiKey = req.headers['x-api-key'] || req.headers['X-Api-Key'];
const apiSecret = req.headers['x-api-secret'] || req.headers['X-Api-Secret'];
```

#### B. –ö–ª—é—á—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –±–µ–∑ –ø—Ä–µ—Ñ—ñ–∫—Å—ñ–≤
–Ø–∫—â–æ –≤ –ë–î –∫–ª—é—á—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –±–µ–∑ –ø—Ä–µ—Ñ—ñ–∫—Å—ñ–≤ `ak_` —Ç–∞ `as_`, –∞ middleware –¥–æ–¥–∞—î —ó—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ, —Ç–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –Ω–µ —Å–ø—Ä–∞—Ü—é—î.

#### C. –•–µ—à—É–≤–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤
–Ø–∫—â–æ –≤ –ë–î –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —Ö–µ—à—ñ –∫–ª—é—á—ñ–≤, –∞ –Ω–µ —Å–∞–º—ñ –∫–ª—é—á—ñ, —Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ö–µ—à—É–≤–∞—Ç–∏ –≤—Ö—ñ–¥–Ω—ñ –∫–ª—é—á—ñ –ø–µ—Ä–µ–¥ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è–º.

#### D. –ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–ª—é—á—ñ–≤
–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ–ª–µ `is_active` –∞–±–æ `status` –≤ —Ç–∞–±–ª–∏—Ü—ñ API –∫–ª—é—á—ñ–≤.

## üìã –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è backend –∫–æ–º–∞–Ω–¥–∏:

1. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —ñ—Å–Ω—É—é—Ç—å –∫–ª—é—á—ñ –≤ –ë–î
2. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–ª—é—á—ñ–≤ (`is_active = true`)
3. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ñ–æ—Ä–º–∞—Ç –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–ª—é—á—ñ–≤ (–∑ –ø—Ä–µ—Ñ—ñ–∫—Å–∞–º–∏ —á–∏ –±–µ–∑)
4. ‚úÖ –î–æ–¥–∞—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤ middleware –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
5. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ case-sensitive –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤
6. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∞—Ü—é—î —Ñ—É–Ω–∫—Ü—ñ—è `authenticateApiKeyWithSecret`

## üß™ –¢–µ—Å—Ç–æ–≤–∏–π –∑–∞–ø–∏—Ç –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:

```bash
# –¢–µ—Å—Ç 1: –ó –Ω–∏–∂–Ω—ñ–º —Ä–µ–≥—ñ—Å—Ç—Ä–æ–º
curl -H "x-api-key: ak_aa4d19418b385c370939b45365d0c687ddbdef7cbe9a72548748ef67f5e469e1" \
     -H "x-api-secret: as_623caef2632983630ce11293e544504c834a9ab1015fa2c75a7c2583d6f28d7c" \
     https://admin.foryou-realestate.com/api/public/data

# –¢–µ—Å—Ç 2: –ó –≤–µ—Ä—Ö–Ω—ñ–º —Ä–µ–≥—ñ—Å—Ç—Ä–æ–º (—è–∫—â–æ case-sensitive)
curl -H "X-Api-Key: ak_aa4d19418b385c370939b45365d0c687ddbdef7cbe9a72548748ef67f5e469e1" \
     -H "X-Api-Secret: as_623caef2632983630ce11293e544504c834a9ab1015fa2c75a7c2583d6f28d7c" \
     https://admin.foryou-realestate.com/api/public/data
```

## üìù –í–∏—Å–Ω–æ–≤–æ–∫:

**–ü—Ä–æ–±–ª–µ–º–∞ 100% –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ.** –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∞–ª–µ –±–µ–∫–µ–Ω–¥ –Ω–µ –º–æ–∂–µ –≤–∞–ª—ñ–¥—É–≤–∞—Ç–∏ –∫–ª—é—á—ñ. –ü–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:
1. –ù–∞—è–≤–Ω—ñ—Å—Ç—å –∫–ª—é—á—ñ–≤ –≤ –ë–î
2. –ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–ª—é—á—ñ–≤
3. –ü—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å middleware –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∫–ª—é—á—ñ–≤
4. –§–æ—Ä–º–∞—Ç –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–ª—é—á—ñ–≤ –≤ –ë–î

